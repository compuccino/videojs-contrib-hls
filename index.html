<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>videojs-contrib-hls Demo</title>
  <link href="/node_modules/video.js/dist/video-js.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .info {
      background-color: #eee;
      border: thin solid #333;
      border-radius: 3px;
      padding: 0 5px;
      margin: 20px 0;
    }
    .menus {
      background-color: #eee;
      border: thin solid #333;
      border-radius: 3px;
      text-align: center;
    }
    input {
      margin-top: 15px;
      min-width: 450px;
      padding: 5px;
    }
    #videojs-contrib-hls-player {
      width:100%;
    }

    #quality-graph {
      width: 100%;
    }
    #current-quality-attr {
      text-align: left;
      margin-left: 20px;
    }
  </style>

</head>
<body>
  <div class="info">
    <p>The video below is an <a href="https://developer.apple.com/library/ios/documentation/networkinginternet/conceptual/streamingmediaguide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008332-CH1-SW1">HTTP Live Stream</a>. On desktop browsers other than Safari, the HLS plugin will polyfill support for the format on top of the video.js Flash tech.</p>
    <p>Due to security restrictions in Flash, you will have to load this page over HTTP(S) to see the example in action.</p>
  </div>

  <ul>
    <li><a href="/test/">Run unit tests in browser.</a></li>
    <li><a href="/docs/api/">Read generated docs.</a></li>
    <li><a href="/examples">Browse Examples</a></li>
  </ul>

  <p>
    <video id="videojs-contrib-hls-player" class="video-js vjs-default-skin" controls>
      <source>
    </video>
  </p>

  <div class="menus">
    <form id=load-url>
      <label>
        Video URL:
        <input id=url type=url value="https://d2zihajmogu5jn.cloudfront.net/bipbop-advanced/bipbop_16x9_variant.m3u8">
      </label>
      <button type=submit>Load</button>
    </form>

    <p>Select quality/variant: <select id="quality-menu"></select><p>
    <p>Select text track: <select id="text-track-menu"></select></p>
    <p>Select audio track: <select id="audio-track-menu"></select></p>
    <p>Select video track: <select id="video-track-menu"></select></p>

    <p>
      Media attributes at playhead:
      <p><pre id="current-quality-attr">{}</pre></p>
    </p>
  </div>

  <p>
    <ul>
      <li>Trace 0: Recommended BANDWIDTHs of playlists selected</li>
      <li>Trace 1: Effective bitrates of segments loaded</li>
    </ul>
    <div id="quality-graph"></div>
  </p>

  <script src="https://cdn.plot.ly/plotly-1.28.3.min.js"></script>
  <script src="/node_modules/jquery/dist/jquery.js"></script>
  <script src="/node_modules/video.js/dist/video.js"></script>
  <script src="/node_modules/videojs-contrib-quality-levels/dist/videojs-contrib-quality-levels.js"></script>

  <script src="/dist/videojs-contrib-hls.js"></script>
  <script>
    (function(window, videojs) {

      var videojsHlsDemo;
      var player;
      var hlsMimeType = "application/x-mpegURL";
      //var urlHref = "https://d2zihajmogu5jn.cloudfront.net/bipbop-advanced/bipbop_16x9_variant.m3u8";
      var urlHref = "http://ingest0.compuccino.tv/vod/smil:development.smil/playlist.m3u8";

      var loadUrl = document.getElementById('load-url');
      var url = document.getElementById('url');
      var sourceEl = document.querySelector('video source');

      var playerOptions = {
        html5: {
          hls: {
            debug: true,
            smoothQualitySwitch: true,
            disableImmediateQualityChange: true
          }
        }
      };

      // setup url input
      url.value = urlHref;

      // setup source element
      sourceEl.src = urlHref;
      sourceEl.type = hlsMimeType;

      // create player
      player = window.player = videojs('videojs-contrib-hls-player', playerOptions);

      // hook up the video switcher
      loadUrl.addEventListener('submit', function(event) {
        event.preventDefault();
        player.src({
          src: url.value,
          type: hlsMimeType
        });
        return false;
      });

      player.on('loadedmetadata', function() {
        videojsHlsDemo.hlsHandler = player.tech_.hls;
      });

      videojsHlsDemo = window.videojsContribHlsDemo = {
        player: player,
        url: urlHref,
        hlsHandler: null
      };

    }(window, window.videojs));
  </script>

  <script src="demo.js"></script>

</body>
</html>